Index: freefem++-3.7.1/acoptim.m4
===================================================================
--- freefem++-3.7.1.orig/acoptim.m4	2010-01-15 15:22:31.000000000 +0100
+++ freefem++-3.7.1/acoptim.m4	2010-01-15 14:49:07.000000000 +0100
@@ -47,14 +47,6 @@
 AC_ARG_ENABLE(debug,[  --enable-debug	Turn on debug versions of FreeFem++])
 AC_ARG_ENABLE(optim,[  --enable-optim	Turn on compiler optimization])
 
-# Autoconf always chooses -O2. -O2 in gcc makes some functions
-# disappear. This is not ideal for debugging. And when we optimize, we
-# do not use -O2 anyway.
-
-CFLAGS="`echo $CFLAGS | sed 's/-O2//g'`"
-FFLAGS="`echo $FFLAGS | sed 's/-O2//g'`"
-CXXFLAGS="`echo $CXXFLAGS | sed 's/-O2//g'`"
-
 if test "$enable_debug" = yes;
 then
 	AC_MSG_RESULT(yes)
@@ -63,9 +55,9 @@
 
 	# No debugging information in optimized code
 
-	CFLAGS="`echo $CFLAGS | sed 's/-g//g'` -DNDEBUG"
-	FFLAGS="`echo $FFLAGS | sed 's/-g//g'` -DNDEBUG"
-	CXXFLAGS="`echo $CXXFLAGS | sed 's/-g//g'` -DNDEBUG"
+	CFLAGS="$CFLAGS -DNDEBUG"
+	FFLAGS="$FFLAGS -DNDEBUG"
+	CXXFLAGS="$CXXFLAGS -DNDEBUG"
 fi
 
 # Hardware-independant optimization
@@ -99,6 +91,14 @@
     -a "$enable_generic" != yes
 then
 
+# Autoconf always chooses -O2. -O2 in gcc makes some functions
+# disappear. This is not ideal for debugging. And when we optimize, we
+# do not use -O2 anyway.
+
+CFLAGS="`echo $CFLAGS | sed 's/-O2//g'`"
+FFLAGS="`echo $FFLAGS | sed 's/-O2//g'`"
+CXXFLAGS="`echo $CXXFLAGS | sed 's/-O2//g'`"
+
     # MacOS X Darwin
     if test -x /usr/bin/hostinfo
 	then
Index: freefem++-3.7.1/examples++-load/Makefile.am
===================================================================
--- freefem++-3.7.1.orig/examples++-load/Makefile.am	2010-01-15 15:22:31.000000000 +0100
+++ freefem++-3.7.1/examples++-load/Makefile.am	2010-01-15 15:38:21.000000000 +0100
@@ -70,7 +70,7 @@
 
 include: include.tar.gz
 	rm -rf include 
-	gunzip -c include.tar.gz| tar xvf -
+	tar zxvf include.tar.gz --owner=`whoami` 
 	-rm -f include/._*
 #	-cp -rf ../download/include/* include/.
 
@@ -121,19 +121,19 @@
 freefem++.pref:
 	echo loadpath = \"./\" >freefem++.pref
 install-exec-local:: load_compile
-	$(mkinstalldirs) -m 755 $(DESTDIR)$(ff_prefix_dir)/lib
-	$(mkinstalldirs) -m 755 $(DESTDIR)$(ff_prefix_dir)/include
-	$(mkinstalldirs) -m 755 $(DESTDIR)$(ff_prefix_dir)/etc
-	$(INSTALL_DATA)  include/* $(DESTDIR)$(ff_prefix_dir)/include
-	$(INSTALL)  -m 555 $(LIST_COMPILE) $(DESTDIR)$(ff_prefix_dir)/lib
-	echo loadpath += \"./\"  >$(DESTDIR)$(ff_prefix_dir)/etc/freefem++.pref
-	echo loadpath += \"$(ff_prefix_dir)/lib\"  >>$(DESTDIR)$(ff_prefix_dir)/etc/freefem++.pref
-	echo includepath += \"$(ff_prefix_dir)/edp\"  >>$(DESTDIR)$(ff_prefix_dir)/etc/freefem++.pref
+	$(mkinstalldirs) -m 755 $(DESTDIR)$(libdir)/freefem++
+	$(mkinstalldirs) -m 755 $(DESTDIR)$(includedir)/freefem++
+	$(mkinstalldirs) -m 755 $(DESTDIR)/etc
+	$(INSTALL_DATA)  include/* $(DESTDIR)$(includedir)/freefem++
+	$(INSTALL)  -m 555 $(LIST_COMPILE) $(DESTDIR)$(libdir)/freefem++
+	echo loadpath += \"./\"  >$(DESTDIR)/etc/freefem++.pref
+	echo loadpath += \"$(libdir)/freefem++\"  >>$(DESTDIR)/etc/freefem++.pref
+	echo includepath += \"$(ff_prefix_dir)/edp\"  >>$(DESTDIR)/etc/freefem++.pref
 	$(INSTALL_SCRIPT) ff-c++  $(DESTDIR)${bindir}
 	$(INSTALL_SCRIPT) ff-pkg-download  $(DESTDIR)${bindir}
 	$(INSTALL_SCRIPT) ff-get-dep  $(DESTDIR)${bindir}
 	-for i in $(LIST_COMPILE_PKG); do \
-	 if [ -f $$i ] ; then 	$(INSTALL)  -m 555 $$i $(DESTDIR)$(ff_prefix_dir)/lib; fi; done
+	 if [ -f $$i ] ; then 	$(INSTALL)  -m 555 $$i $(DESTDIR)$(libdir)/freefem++; fi; done
 
 
 
